Model: "model"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
input_1 (InputLayer)         [(None, 400, 40, 1)]      0         
_________________________________________________________________
dropout (Dropout)            (None, 400, 40, 1)        0         
_________________________________________________________________
conv2d (Conv2D)              (None, 400, 40, 32)       320       
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 200, 20, 32)       0         
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 200, 20, 64)       18496     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 100, 10, 64)       0         
_________________________________________________________________
conv2d_2 (Conv2D)            (None, 100, 10, 128)      73856     
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 100, 10, 256)      295168    
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 10, 10, 256)       0         
_________________________________________________________________
flatten (Flatten)            (None, 25600)             0         
_________________________________________________________________
embeddings (Dense)           (None, 2000)              51202000  
_________________________________________________________________
flattened_encoder_output (Fl (None, 2000)              0         
_________________________________________________________________
clustering (DECLayer)        (None, 5)                 10000     
=================================================================
Total params: 51,599,840
Trainable params: 51,599,840
Non-trainable params: 0
_________________________________________________________________
=======================ite: 0
Distances:
[[ 0.       27.806622 14.585036 14.244879 21.01446 ]
 [27.806622  0.       20.805141 32.11789  40.113598]
 [14.585036 20.805141  0.       17.745111 25.32901 ]
 [14.244879 32.11789  17.745111  0.       15.863773]
 [21.01446  40.113598 25.32901  15.863773  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[13 57 25  0 15]
 [ 1  0 67  0  1]
 [21  1  8 10 67]
 [28 41  0 90 16]
 [37  1  0  0  1]]
True label en classified as 4, likelihood 0.37
True label de classified as 0, likelihood 0.57
True label cn classified as 1, likelihood 0.67
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.67
=======================ite: 16
Distances:
[[ 0.       27.806648 14.585087 14.24495  21.014498]
 [27.806648  0.       20.805157 32.11794  40.113636]
 [14.585087 20.805157  0.       17.745178 25.329056]
 [14.24495  32.11794  17.745178  0.       15.8638  ]
 [21.014498 40.113636 25.329056 15.8638    0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[14 57 25  0 16]
 [ 1  0 67  0  1]
 [20  1  8 10 64]
 [29 42  0 90 19]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 0, likelihood 0.57
True label cn classified as 1, likelihood 0.67
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.64
=======================ite: 32
Distances:
[[ 0.       27.806667 14.585134 14.245017 21.014534]
 [27.806667  0.       20.805168 32.11798  40.113667]
 [14.585134 20.805168  0.       17.745241 25.329098]
 [14.245017 32.11798  17.745241  0.       15.86382 ]
 [21.014534 40.113667 25.329098 15.86382   0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[15 51 25  0 18]
 [ 1  0 64  0  1]
 [16  1 11 10 60]
 [31 47  0 90 21]
 [37  1  0  0  0]]
True label en classified as 4, likelihood 0.37
True label de classified as 0, likelihood 0.51
True label cn classified as 1, likelihood 0.64
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.6
=======================ite: 48
Distances:
[[ 0.       27.806684 14.585179 14.245084 21.014568]
 [27.806684  0.       20.805176 32.118027 40.113693]
 [14.585179 20.805176  0.       17.745306 25.329142]
 [14.245084 32.118027 17.745306  0.       15.863838]
 [21.014568 40.113693 25.329142 15.863838  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[14 56 25  0 16]
 [ 1  0 66  0  1]
 [18  1  9 10 64]
 [31 43  0 90 19]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 0, likelihood 0.56
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.64
=======================ite: 64
Distances:
[[ 0.       27.806702 14.585228 14.245155 21.014606]
 [27.806702  0.       20.805187 32.118076 40.113728]
 [14.585228 20.805187  0.       17.745377 25.329187]
 [14.245155 32.118076 17.745377  0.       15.863858]
 [21.014606 40.113728 25.329187 15.863858  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[14 54 25  0 17]
 [ 1  0 66  0  1]
 [18  1  9 10 63]
 [31 45  0 90 19]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 0, likelihood 0.54
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.63
=======================ite: 80
Distances:
[[ 0.       27.806719 14.585273 14.245221 21.014643]
 [27.806719  0.       20.805195 32.118122 40.113758]
 [14.585273 20.805195  0.       17.745441 25.32923 ]
 [14.245221 32.118122 17.745441  0.       15.863876]
 [21.014643 40.113758 25.32923  15.863876  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[14 50 25  0 16]
 [ 1  0 65  0  1]
 [17  1 10 10 63]
 [31 49  0 90 20]
 [37  0  0  0  0]]
True label en classified as 4, likelihood 0.37
True label de classified as 0, likelihood 0.5
True label cn classified as 1, likelihood 0.65
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.63
=======================ite: 96
Distances:
[[ 0.       27.806732 14.585317 14.245287 21.014679]
 [27.806732  0.       20.805202 32.118164 40.113785]
 [14.585317 20.805202  0.       17.745508 25.329271]
 [14.245287 32.118164 17.745508  0.       15.863894]
 [21.014679 40.113785 25.329271 15.863894  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[14 54 25  0 15]
 [ 1  0 66  0  1]
 [18  1  9 10 66]
 [31 45  0 90 18]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 0, likelihood 0.54
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.66
=======================ite: 112
Distances:
[[ 0.       27.80675  14.585363 14.245357 21.014717]
 [27.80675   0.       20.805214 32.118214 40.11382 ]
 [14.585363 20.805214  0.       17.745579 25.329317]
 [14.245357 32.118214 17.745579  0.       15.863914]
 [21.014717 40.11382  25.329317 15.863914  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[14 52 25  0 15]
 [ 1  0 66  0  1]
 [18  1  9 10 66]
 [31 47  0 90 18]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 0, likelihood 0.52
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.66
=======================ite: 128
Distances:
[[ 0.        27.806763  14.585406  14.2454195 21.014751 ]
 [27.806763   0.        20.805222  32.11826   40.11385  ]
 [14.585406  20.805222   0.        17.745644  25.32936  ]
 [14.2454195 32.11826   17.745644   0.        15.863931 ]
 [21.014751  40.11385   25.32936   15.863931   0.       ]]
Prediction results 
(pred_axis, truth_axis) 
[[13 49 25  0 15]
 [ 1  0 65  0  1]
 [17  1 10 10 64]
 [32 50  0 90 20]
 [37  0  0  0  0]]
True label en classified as 4, likelihood 0.37
True label de classified as 3, likelihood 0.5
True label cn classified as 1, likelihood 0.65
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.64
=======================ite: 144
Distances:
[[ 0.        27.806776  14.585448  14.2454815 21.014788 ]
 [27.806776   0.        20.80523   32.1183    40.113876 ]
 [14.585448  20.80523    0.        17.74571   25.329403 ]
 [14.2454815 32.1183    17.74571    0.        15.863946 ]
 [21.014788  40.113876  25.329403  15.863946   0.       ]]
Prediction results 
(pred_axis, truth_axis) 
[[14 52 25  0 15]
 [ 1  0 66  0  1]
 [18  1  9 10 67]
 [31 47  0 90 17]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 0, likelihood 0.52
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.67
=======================ite: 160
Distances:
[[ 0.       27.806791 14.585492 14.245546 21.014826]
 [27.806791  0.       20.805239 32.118347 40.11391 ]
 [14.585492 20.805239  0.       17.745779 25.329447]
 [14.245546 32.118347 17.745779  0.       15.863962]
 [21.014826 40.11391  25.329447 15.863962  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[14 52 25  0 14]
 [ 1  0 66  0  1]
 [18  1  9 10 68]
 [31 47  0 90 17]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 0, likelihood 0.52
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.68
=======================ite: 176
Distances:
[[ 0.       27.806803 14.585533 14.245605 21.01486 ]
 [27.806803  0.       20.805244 32.118393 40.113937]
 [14.585533 20.805244  0.       17.745844 25.32949 ]
 [14.245605 32.118393 17.745844  0.       15.863975]
 [21.01486  40.113937 25.32949  15.863975  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[13 49 25  0 14]
 [ 1  0 65  0  1]
 [18  1 10 10 67]
 [31 50  0 90 17]
 [37  0  0  0  1]]
True label en classified as 4, likelihood 0.37
True label de classified as 3, likelihood 0.5
True label cn classified as 1, likelihood 0.65
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.67
=======================ite: 192
Distances:
[[ 0.       27.806814 14.585573 14.245664 21.014894]
 [27.806814  0.       20.805252 32.118435 40.113968]
 [14.585573 20.805252  0.       17.745907 25.32953 ]
 [14.245664 32.118435 17.745907  0.       15.863985]
 [21.014894 40.113968 25.32953  15.863985  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[14 52 25  0 14]
 [ 1  0 66  0  1]
 [18  1  9 10 68]
 [31 47  0 90 17]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 0, likelihood 0.52
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.68
=======================ite: 208
Distances:
[[ 0.       27.80683  14.585615 14.245725 21.014929]
 [27.80683   0.       20.805262 32.11848  40.114   ]
 [14.585615 20.805262  0.       17.745975 25.329576]
 [14.245725 32.11848  17.745975  0.       15.863995]
 [21.014929 40.114    25.329576 15.863995  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[13 52 25  0 13]
 [ 1  0 66  0  1]
 [19  1  9 10 69]
 [31 47  0 90 17]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 0, likelihood 0.52
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.69
=======================ite: 224
Distances:
[[ 0.       27.806839 14.585653 14.245781 21.014963]
 [27.806839  0.       20.805267 32.11852  40.114025]
 [14.585653 20.805267  0.       17.74604  25.329618]
 [14.245781 32.11852  17.74604   0.       15.864002]
 [21.014963 40.114025 25.329618 15.864002  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[13 48 25  0 14]
 [ 1  0 65  0  1]
 [18  1 10 10 66]
 [32 51  0 90 19]
 [36  0  0  0  0]]
True label en classified as 4, likelihood 0.36
True label de classified as 3, likelihood 0.51
True label cn classified as 1, likelihood 0.65
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.66
=======================ite: 240
Distances:
[[ 0.       27.80685  14.58569  14.245836 21.014996]
 [27.80685   0.       20.805275 32.11856  40.114056]
 [14.58569  20.805275  0.       17.746105 25.329659]
 [14.245836 32.11856  17.746105  0.       15.864007]
 [21.014996 40.114056 25.329659 15.864007  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[13 51 25  0 13]
 [ 1  0 66  0  1]
 [19  1  9 10 69]
 [32 48  0 90 17]
 [35  0  0  0  0]]
True label en classified as 4, likelihood 0.35
True label de classified as 0, likelihood 0.51
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.69
=======================ite: 256
Distances:
[[ 0.       27.806864 14.58573  14.245896 21.015028]
 [27.806864  0.       20.805283 32.118607 40.114086]
 [14.58573  20.805283  0.       17.746174 25.329702]
 [14.245896 32.118607 17.746174  0.       15.864012]
 [21.015028 40.114086 25.329702 15.864012  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[13 50 25  0 13]
 [ 1  0 66  0  1]
 [19  2  9 10 69]
 [32 48  0 90 17]
 [35  0  0  0  0]]
True label en classified as 4, likelihood 0.35
True label de classified as 0, likelihood 0.5
True label cn classified as 1, likelihood 0.66
True label fr classified as 3, likelihood 0.9
True label ru classified as 2, likelihood 0.69






More training (1800 iterations) leads to misclassification of de

=======================ite: 1536
Distances:
[[ 0.       22.431566 16.450949 40.928036 26.031868]
 [22.431566  0.       14.343794 27.53609  14.545246]
 [16.450949 14.343794  0.       32.13112  17.618103]
 [40.928036 27.53609  32.13112   0.       20.856777]
 [26.031868 14.545246 17.618103 20.856777  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[34  0  0  0  0]
 [12 38 25  0 12]
 [32 60  0 90 19]
 [ 1  0 67  0  0]
 [21  2  8 10 69]]
True label en classified as 0, likelihood 0.34
True label de classified as 2, likelihood 0.6
True label cn classified as 3, likelihood 0.67
True label fr classified as 2, likelihood 0.9
True label ru classified as 4, likelihood 0.69

=======================ite: 1792
Distances:
[[ 0.       22.431814 16.450615 40.92839  26.032404]
 [22.431814  0.       14.344411 27.53616  14.545561]
 [16.450615 14.344411  0.       32.131653 17.619236]
 [40.92839  27.53616  32.131653  0.       20.856718]
 [26.032404 14.545561 17.619236 20.856718  0.      ]]
Prediction results 
(pred_axis, truth_axis) 
[[32  0  0  0  0]
 [13 38 25  0 14]
 [33 60  0 90 18]
 [ 1  0 67  0  0]
 [21  2  8 10 68]]
True label en classified as 2, likelihood 0.33
True label de classified as 2, likelihood 0.6
True label cn classified as 3, likelihood 0.67
True label fr classified as 2, likelihood 0.9
True label ru classified as 4, likelihood 0.68